# ipCamWeb

Лёгкое веб-приложение для просмотра и управления IP-камерой в локальной сети через ONVIF и RTSP. Backend на Node.js обеспечивает проксирование ONVIF-запросов и трансляцию RTSP-потока в браузер, а фронтенд на одной HTML-странице показывает видео и предоставляет PTZ-управление и настройки.

## Возможности
- Отображение видеопотока с камеры в браузере через WebSocket + JSMpeg (RTSP \u2192 MPEG-TS).
- PTZ-управление: панорамирование, наклон, зум.
- Базовые настройки камеры и подключение по IP/логину/паролю.
- Работа внутри локальной сети без необходимости глобальной адресации.

## Почему нужен backend
- Браузеры не поддерживают RTSP и ONVIF напрямую.
- Камеры редко выставляют CORS-заголовки, поэтому прямые запросы из браузера блокируются.
- FFmpeg в Node.js-конвейере конвертирует RTSP в поток, который можно показывать в браузере.

## Архитектура
- **Backend**: Node.js + Express.
  - `node-onvif` для ONVIF-запросов (подключение, PTZ, настройки).
  - `ffmpeg` + WebSocket (например, `ws` или `node-rtsp-stream`) для проксирования видеопотока.
  - REST API для подключения к камере и отправки команд PTZ.
- **Frontend**: статические файлы в `public/`.
  - `index.html` с канвой JSMpeg для видео.
  - `app.js` для вызова API и инициализации JSMpeg.
  - `style.css` для оформления (тёмная тема).

## Структура (план)
- `server.js` — Express-приложение, конфигурация ffmpeg-пайплайна и WebSocket-трансляции.
- `public/index.html` — UI: канвас видео, блок PTZ, форма подключения.
- `public/app.js` — логика подключения, PTZ-команды, запуск JSMpeg.
- `public/style.css` — стили интерфейса.

## Требования
- Node.js LTS.
- FFmpeg установлен в системе и доступен в `$PATH`.

## Быстрый старт (концепт)
1. Установите зависимости:
   ```bash
   npm install
   ```
2. Запустите сервер:
   ```bash
   node server.js
   ```
3. Откройте `http://localhost:3000`, укажите IP, логин и пароль камеры и начните просмотр.

## REST API (черновик)
- `POST /api/connect` — { ip, username, password } для установки сессии ONVIF/RTSP.
- `POST /api/ptz/move` — { direction, speed } для PTZ-команд.
- WebSocket `/api/stream` — поток MPEG-TS для JSMpeg.

## Верификация
- Проверка, что сервер поднимается без ошибок.
- UI загружает страницу и инициализирует WebSocket-подключение.
- API принимает запросы и проксирует их в камеру (при наличии устройства в сети).
